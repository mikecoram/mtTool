function relChord(e,o,t){this.chordType=e,this.keyName=o,this.degree=t}function relNote(e,o,t){this.chordType=e,this.gapFromRoot=o,this.division=t}function chordType(e,o,t){this.chordType=e,this.noteAmount=o,this.typeColor=t}function storeChord(e,o,t,r){var n=new relChord(o,t,r);localStorage.setItem(e,JSON.stringify(n))}function storeNote(e,o,t,r){var n=new relNote(o,t,r);localStorage.setItem(e,JSON.stringify(n))}function storeChordType(e,o,t){var r=new chordType(e,o,t);localStorage.setItem(e,JSON.stringify(r))}function populateDropBox(e,o){for(var t=document.getElementById(e),r=0;r<o.length;r++){var n=document.createElement("option");n.text=o[r],n.value=o[r],t.add(n)}}function populateChordTypes(){for(var e=1;7>=e;e++)populateDropBox("o"+e+"chordtype",chordTypes)}function resetCanvas(e){e.clearRect(0,0,scaleCanvas.width,scaleCanvas.height),e.drawImage(imageObj,0,0)}function resetChordInspector(){removeElementsByClass("note"),removeElementsByClass("note-divi")}function removeElementsByClass(e){for(var o=document.getElementsByClassName(e);o.length>0;)o[0].parentNode.removeChild(o[0])}function getKeyColor(){var e=getObject(inputType.value);return e.typeColor}function getObject(e){return JSON.parse(localStorage.getItem(e))}function setElementColor(e,o){document.getElementById(e).style.backgroundColor=o}function setElementContent(e,o,t){0==t?document.getElementById(e).innerHTML=o:document.getElementById(e).innerHTML+=o}function getSemiGap(e,o){for(var t=0,r=0;r<e.length;r++)if(o==e[r]){t=r;break}return t}function getxMod(e){return e.length>1?bxoffset:0}function getxDist(e,o){for(var t=0,r=0;r<e.length,o>r;r++)t+="B"==e[r]||"E"==e[r]?xoffset:bxoffset;return t}function getyDist(e){return e.length>1?byoffset:yoffset}function getScaleBase(e){var o;switch(e.charAt(0)){case"G":o=-3;break;case"A":o=-2;break;case"B":o=-1;break;case"C":o=0;break;case"D":o=1;break;case"E":o=2;break;case"F":o=3}return o}function getChordBase(e){var o;switch(keyNote.charAt(0)){case"C":o=0;break;case"D":o=1;break;case"E":o=2;break;case"F":o=3;break;case"G":o=4;break;case"A":o=5;break;case"B":o=6}return o}function drawNote(e,o,t,r,n,a){e.length>1?drawCircle(r+o,t,circleRadius,a,n):drawCircle(r+o,t,circleRadius,a,n)}function drawCircle(e,o,t,r,n){n.beginPath(),n.arc(e,o,t,0,2*Math.PI,!1),n.fillStyle=r,n.fill(),n.lineWidth=5,n.strokeStyle="#000000",n.lineWidth=2,n.stroke()}function pressSubmit(){var e=shuffleNotes(inputRoot.value),o=getScale(inputRoot.value,inputType.value);resetCanvas(scaleContext),resetCanvas(chordContext),resetChordInspector(),setElementContent("chord-title","Hover over a chord...",0);for(var t=0;t<o.length;t++){setElementContent("o"+(t+1)+"chordroot",o[t],0);var r=getxDist(e,getSemiGap(e,o[t])),n=getyDist(o[t]),a=getObject(inputType.value+"chord"+(t+1)),i=getObject(a.chordType),s=getKeyColor();document.getElementById("multiColor").checked&&(s=i.typeColor),drawNote(o[t],r,n,midC+getxMod(o[0])+getScaleBase(o[0])*xoffset,scaleContext,s),setElementColor("o"+(t+1),i.typeColor),setDefType(a.chordType,t),printNotes(i,o[t],t)}}function showChord(e){var o=getScale(inputRoot.value,inputType.value),t=shuffleNotes(o[e-1]),r=(getObject(inputType.value+"chord"+e),getObject(document.getElementById("o"+e+"chordtype").value)),n=getScaleBase(o[e-1]);setElementContent("chord-title",o[e-1]+" "+r.chordType+" chord",0),resetCanvas(chordContext);for(var a=0;a<r.noteAmount;a++){var i=getObject(r.chordType+"note"+(a+1)),s=t[i.gapFromRoot],c=getxDist(t,getSemiGap(t,s)),d=getyDist(s);drawNote(s,c,d,midC+n*xoffset+getxMod(o[e-1]),chordContext,r.typeColor)}}function changeType(e){document.getElementById("o"+e+"notes").innerHTML="";var o=getScale(inputRoot.value,inputType.value),t=getObject(document.getElementById("o"+e+"chordtype").value);setElementColor("o"+e,t.typeColor),printNotes(t,o[e-1],e-1),showChord(e)}function resetType(e){var o=getObject(inputType.value+"chord"+e);setDefType(o.chordType,e-1),changeType(e)}function setDefType(e,o){for(var t=document.getElementById("o"+(o+1)+"chordtype"),r=0;r<t.options.length;r++)if(e==t.options[r].innerHTML){t.selectedIndex=r;break}}function printNotes(e,o,t){for(var r=document.getElementById("o"+(t+1)+"notes"),n=1;n<=e.noteAmount;n++){var a=getObject(e.chordType+"note"+n),i=document.createElement("div");i.className="note-divi",i.innerHTML=a.division,r.appendChild(i);var s=document.createElement("div");s.className="note",s.innerHTML=getNote(o,a.gapFromRoot),r.appendChild(s)}}function getNote(e,o){var t=shuffleNotes(e);return t[o]}function getScale(e,o){var t=shuffleNotes(e),r=new Array(7),n=0,a=0;"major"==o?(n=2,a=6):"minor"==o&&(n=1,a=4);for(var i=0,s=0;s<r.length;s++)r[s]=t[i],i+=s==n||s==a?1:2;return r}function shuffleNotes(e){for(var o=new Array(note.length),t=0,r=0;r<note.length;r++)if(note[r]==e){t=r;break}for(var n=t,r=0;r<note.length;r++)n>11&&(n=0),o[r]=note[n++];return o}var note=["A","A#/Bb","B","C","C#/Db","D","D#/Eb","E","F","F#/Gb","G","G#/Ab"],keyTypes=["major","minor"],chordTypes=["major","minor","diminished","augmented"],othercolor="#8BA2FF",majcolor="#FFFF9D";storeChordType("major",3,majcolor),storeNote("majornote1","major",0,"I"),storeNote("majornote2","major",4,"III"),storeNote("majornote3","major",7,"V");var mincolor="#BEEB9F";storeChordType("minor",3,mincolor),storeNote("minornote1","minor",0,"I"),storeNote("minornote2","minor",3,"IIIb"),storeNote("minornote3","minor",7,"V");var augcolor=othercolor;storeChordType("augmented",3,augcolor),storeNote("augmentednote1","augmented",0,"I"),storeNote("augmentednote2","augmented",4,"III#"),storeNote("augmentednote3","augmented",8,"V#");var dimcolor="#EE6138";storeChordType("diminished",3,dimcolor),storeNote("diminishednote1","diminished",0,"I"),storeNote("diminishednote2","diminished",3,"IIIb"),storeNote("diminishednote3","diminished",6,"Vb"),storeChord("majorchord1","major","major",1),storeChord("majorchord2","minor","major",1),storeChord("majorchord3","minor","major",3),storeChord("majorchord4","major","major",4),storeChord("majorchord5","major","major",5),storeChord("majorchord6","minor","major",6),storeChord("majorchord7","diminished","major",7),storeChord("minorchord1","minor","minor",1),storeChord("minorchord2","diminished","minor",2),storeChord("minorchord3","major","minor",3),storeChord("minorchord4","minor","minor",4),storeChord("minorchord5","minor","minor",5),storeChord("minorchord6","major","minor",6),storeChord("minorchord7","major","minor",7);const scaleCanvas=document.getElementById("scalePiano"),scaleContext=scaleCanvas.getContext("2d"),chordCanvas=document.getElementById("chordPiano"),chordContext=chordCanvas.getContext("2d");var imageObj=new Image;imageObj.src="img/piano.png";const circleRadius=7,midC=270,yoffset=120,xoffset=36,bxoffset=18,byoffset=70;populateDropBox("inputRoot",note),populateDropBox("inputType",keyTypes),document.getElementById("inputRoot").selectedIndex=3,populateChordTypes();